function H = H_Rinotts(k, P, NU)
    H_x(1) = 0.044489365833267;
    H_x(2) = 0.234526109519619;
    H_x(3) = 0.576884629301886;
    H_x(4) = 1.07244875381782;
    H_x(5) = 1.72240877644465;
    H_x(6) = 2.52833670642579;
    H_x(7) = 3.49221327302199;
    H_x(8) = 4.61645676974977;
    H_x(9) = 5.90395850417424;
    H_x(10) = 7.35812673318624;
    H_x(11) = 8.9829409242126;
    H_x(12) = 10.78301863254;
    H_x(13) = 12.7636979867427;
    H_x(14) = 14.9311397555226;
    H_x(15) = 17.2924543367153;
    H_x(16) = 19.8558609403361;
    H_x(17) = 22.6308890131968;
    H_x(18) = 25.6286360224592;
    H_x(19) = 28.8621018163235;
    H_x(20) = 32.3466291539647;
    H_x(21) = 36.100494805752;
    H_x(22) = 40.1457197715394;
    H_x(23) = 44.5092079957549;
    H_x(24) = 49.2243949873086;
    H_x(25) = 54.3337213333969;
    H_x(26) = 59.892509162134;
    H_x(27) = 65.975377287935;
    H_x(28) = 72.6876280906627;
    H_x(29) = 80.1874469779135;
    H_x(30) = 88.7353404178924;
    H_x(31) = 98.829542868284;
    H_x(32) = 111.751398097938;
    H_W(1) = 0.109218341952385;
    H_W(2) = 0.210443107938813;
    H_W(3) = 0.235213229669848;
    H_W(4) = 0.195903335972881;
    H_W(5) = 0.129983786286072;
    H_W(6) = 7.05786238657174E-02;
    H_W(7) = 3.17609125091751E-02;
    H_W(8) = 1.19182148348386E-02;
    H_W(9) = 3.73881629461152E-03;
    H_W(10) = 9.80803306614955E-04;
    H_W(11) = 2.14864918801364E-04;
    H_W(12) = 3.92034196798795E-05;
    H_W(13) = 5.93454161286863E-06;
    H_W(14) = 7.41640457866755E-07;
    H_W(15) = 7.60456787912078E-08;
    H_W(16) = 6.35060222662581E-09;
    H_W(17) = 4.28138297104093E-10;
    H_W(18) = 2.30589949189134E-11;
    H_W(19) = 9.79937928872709E-13;
    H_W(20) = 3.23780165772927E-14;
    H_W(21) = 8.17182344342072E-16;
    H_W(22) = 1.54213383339382E-17;
    H_W(23) = 2.11979229016362E-19;
    H_W(24) = 2.05442967378805E-21;
    H_W(25) = 1.3469825866374E-23;
    H_W(26) = 5.66129413039736E-26;
    H_W(27) = 1.41856054546304E-28;
    H_W(28) = 1.91337549445422E-31;
    H_W(29) = 1.19224876009822E-34;
    H_W(30) = 2.67151121924014E-38;
    H_W(31) = 1.33861694210626E-42;
    H_W(32) = 4.51053619389897E-48;
   
%     NU = 8000;    % n0 in the equation
%     k = 10;    
%     P = 0.95; % P* in the equation
    
    if NU > 60
        H = sqrt(k)*H_NormInv(P);
    else
        for i = 1:32
            WEX(i) = H_W(i) * exp(H_x(i));
        end

        LNGAM(1) = 0.5723649429;
        LNGAM(2) = 0;
        for i = 2:25
            LNGAM( 2*i-1 ) = log (i-1.5) + LNGAM( 2*i-3 );
            LNGAM( 2*i ) = log (i-1) + LNGAM(2*i-2);
        end

        DUMMY = 1;
        H = 4;
        LowerH = 0;
        UpperH = 20;
        ANS = 0; 
        TMP = 0;

        while ~( abs(ANS - P) < 0.001 )
%         for LoopH = 1:50
            ANS = 0;
            for j = 1:32
                TMP = 0;
                for i = 1:32
                    TMP = TMP + (WEX(i) ...
                        * normcdf(H / sqrt( NU*( (1./H_x(i)) + (1./H_x(j)) )./DUMMY )) ...
                        * chi2pdf(DUMMY*H_x(i), NU ) * DUMMY);
                end
                TMP = TMP^(k-1);
                ANS = ANS + WEX(j) * TMP * chi2pdf(DUMMY*H_x(j), NU) * DUMMY;
            end
            if abs(ANS - P) <= 0.000001
                break;
            elseif ANS > P
                UpperH = H;
                H = (LowerH + UpperH)/2;
            else
                LowerH = H;
                H = (LowerH + UpperH)/2;
            end
        end
    end
end
    
%     
%     
% n = NU;    % n0 in the equation
% k = 10;    
% P = 0.95; % P* in the equation
% F = @(x,y,h) normcdf(h./sqrt((n-1)*(1./x+1./y)));
% g1 = @(y,h)integral(@(x) F(x,y,h).*chi2pdf(x,n),0,Inf, 'ArrayValued', true);
% g2 = @(h) integral(@(y) (g1(y,h).^(k-1)).*chi2pdf(y,n),0,Inf)-P;
% bsolve = fzero(g2,0) 